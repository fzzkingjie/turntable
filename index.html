<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1">
	<meta content="telephone=no" name="format-detection">
	<meta name="keywords" content="html,css,js">
	<meta name="description" content="">
	<title>抽奖页</title>
	<link href="" type="image/x-icon" rel="shortcut icon"/> 
	<!-- <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"> -->
	<link type="text/css" href="reset.css" rel="stylesheet"/>
	<style>
	</style>
</head>

<body>
	<!-- <div id="mask" class="mask">
		<div>
			<input type="text">
		</div>
	</div> -->

	<div style="margin-top: 20px;">
		<div class="myscroll">
			<ul>
			</ul>
		</div>
	</div>

	<div class="g-content">
		<div class="g-lottery-case">
			<div class="g-lottery-box">
				<div class="g-lottery-img">
					<a class="playbtn" href="javascript:;" title="开始抽奖"></a>
				</div>
			</div>
		</div>
	</div>

	<div>
	
	</div>

<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.rotate.min.js"></script>
<script type="text/javascript" src="js/scroll.js"></script>
<script type="text/javascript" src="js/layer.js"></script>
<script>
	$(function() {
		$.ajax({
			type: 'GET',
			// url: 'http://192.168.18.224:8080/shop/aafbfd6d60bae9420160baf819880004',
			url: 'test.json',
			dataTYpe: 'JSON',
			data: {},
			success: function(data) {
				for(var i=0; i<data.programmers.length; i++) {
					var $li = $('<li>'+data.programmers[i].email+'</li>');
					$('ul').append($li);
				}
			},
			error: function(){
				var $li = $('<li>暂无商家信息!暂无商家信息!暂无商家信息!</li><li>暂无商家信息!暂无商家信息!暂无商家信息!</li><li>暂无商家信息!暂无商家信息!暂无商家信息!</li>');
				$('ul').append($li);
			}
		})
		// $.getJSON("http://192.168.18.224:8080/shop/aafbfd6d60bae9420160baf819880004",function(json){
		// 	console.log(json);
		// })

		$('.myscroll').myScroll({
			speed: 40, //数值越大，速度越慢
			rowHeight: 26 //li的高度
		});

		var $btn = $('.playbtn');
		var playnum = 20; //初始次数，由后台传入
		$('.playnum').html(playnum);
		var isture = 0;
		var clickfunc = function() {
			var data = [1, 1, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 5, 6, 6, 6, 6, 6, 6, 6];
			//data为随机出来的结果，根据概率后的结果
			data = data[Math.floor(Math.random() * data.length)];
			switch(data) {
				case 1:
					rotateFunc(1, 0, '领流量');
					break;
				case 2:
					rotateFunc(2, 60, '送话费');
					break;
				case 3:
					rotateFunc(3, 120, '购机券');
					break;
				case 4:
					rotateFunc(4, 180, '免费选号');
					break;
				case 5:
					rotateFunc(5, 240, '满减金额');
					break;
				case 6:
					rotateFunc(6, 300, '谢谢惠顾');
					break;
			}
		}
		$btn.click(function() {
			if(isture) return; // 如果在执行就退出
			isture = true; // 标志为 在执行
				if(playnum <= 0) { //当抽奖次数为0的时候执行
					alert("没有次数了");
					$('.playnum').html(0);
					isture = false;
				} else { //还有次数就执行
					playnum = playnum - 1; //执行转盘了则次数减1
					if(playnum <= 0) {
						playnum = 0;
					}
					$('.playnum').html(playnum);
					clickfunc();
				}
		});
		var rotateFunc = function(awards, angle, text) {
			isture = true;
			$btn.stopRotate();
			$btn.rotate({
				angle: 0,
				duration: 4000, //旋转时间
				animateTo: angle + 1440, //让它根据得出来的结果加上1440度旋转
				callback: function() {
					isture = false; // 标志为 执行完毕
					// alert(text);
					if (awards < 6) {
						// showMask();
					} else {
						// showMask();
					}
				}
			});
		};
		// var showMask = function() {
		// 	$("#mask").css("height",$(document).height());
		// 	$("#mask").css("width",$(document).width());
		// 	$("#mask").show();
		// }
		var showMask = function() {
			layer.open({
				type: 1,
				skin: 'footer',
				className: 'showMask-css',
				title: ['输入手机号领取奖励', 'letter-spacing:2px;font-weight:bold;color:#F94C00;'],
				content: '<input type="number" placeholder="请输入手机号" autocomplete="off">',
				btn: ['确定', '取消'],
				anim: 'up',
				shadeClose: false,
			})
		}
	});
</script>
</body>
</html>
